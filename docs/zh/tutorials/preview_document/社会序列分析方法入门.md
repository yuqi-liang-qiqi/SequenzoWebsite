---
title: 社会序列分析方法入门·课程讲义(中文)
description: 社会序列分析方法入门课程讲义的在线预览版本
---

# 社会序列分析方法入门·课程讲义(中文)

## 文档信息

**创建者：** Liang, Yuqi (Rights holder)

## 说明

本资料为公开预览版本,旨在分享教学内容。

欢迎读者阅读、交流与正式引用,但不得复制、改编、转载或用于任何再创作。

若在研究、教学或写作中参考了本资料,请在相应位置注明引用来源(作者与DOI号),以尊重作者劳动成果并维护学术诚信。除引用外的所有使用权均未授予,作者保留全部权利。

**本版本仅开放在线浏览,不提供下载。**

## 引用模板

```
Liang, Y. (2025). 社会序列分析方法入门·课程讲义(Chinese Introductory Lecture Notes on Social Sequence Analysis). Zenodo. https://doi.org/10.5281/zenodo.17752689
```

## 在线预览

<ClientOnly>
<div class="pdf-images-container" id="protected-pdf-container">
  <div class="pdf-viewer-controls">
    <button class="pdf-nav-btn" id="prev-page" aria-label="上一页">&lt; 上一页</button>
    <span class="pdf-page-info">
      <span id="current-page">1</span> / <span id="total-pages">加载中...</span>
    </span>
    <button class="pdf-nav-btn" id="next-page" aria-label="下一页">下一页 &gt;</button>
  </div>
  <div class="pdf-image-wrapper" id="pdf-image-wrapper">
    <div id="pdf-loading-message" style="display: none; text-align: center; padding: 40px; color: var(--vp-c-text-2);">
      <p style="font-size: 16px; margin-bottom: 20px;">⚠️ 图片尚未生成</p>
      <p style="font-size: 14px; margin-bottom: 10px;">请先运行转换脚本生成图片：</p>
      <pre style="background: var(--vp-c-bg-soft); padding: 15px; border-radius: 4px; text-align: left; display: inline-block; font-size: 12px;">
# 1. 安装依赖
pip install -r requirements.txt
brew install poppler  # macOS

# 2. 运行转换脚本
python3 convert_pdf_to_images.py
      </pre>
      <p style="font-size: 12px; margin-top: 20px; color: var(--vp-c-text-3);">
        详细说明请查看 <code>使用说明.md</code>
      </p>
    </div>
    <img 
      id="pdf-main-image" 
      src="/zh/tutorials/preview_document/slides/1764349999820-6c8ddb5c-6d54-4625-9d6a-27c897c9857b_1.jpg" 
      alt="社会序列分析方法入门·课程讲义 - 第 1 页"
      class="pdf-page-image"
      loading="lazy"
    />
  </div>
  <div class="pdf-thumbnails" id="pdf-thumbnails">
    <!-- 缩略图将通过 JavaScript 动态加载 -->
  </div>
</div>
</ClientOnly>

<style scoped>
  .pdf-images-container {
    width: 100%;
    margin: 20px 0;
    border: 1px solid var(--vp-c-divider);
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background: var(--vp-c-bg);
  }
  
  .pdf-viewer-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
    padding: 10px;
    background: var(--vp-c-bg-soft);
    border-radius: 6px;
  }
  
  .pdf-nav-btn {
    padding: 8px 16px;
    background: var(--vp-button-brand-bg);
    color: var(--vp-button-brand-text);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: opacity 0.2s;
  }
  
  .pdf-nav-btn:hover:not(:disabled) {
    opacity: 0.8;
  }
  
  .pdf-nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .pdf-page-info {
    font-size: 14px;
    color: var(--vp-c-text-2);
    min-width: 80px;
    text-align: center;
  }
  
  .pdf-image-wrapper {
    width: 100%;
    text-align: center;
    margin-bottom: 20px;
    min-height: 600px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--vp-c-bg-soft);
    border-radius: 4px;
    padding: 20px;
  }
  
  .pdf-page-image {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
    pointer-events: auto;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
    -webkit-touch-callout: none;
    touch-action: none;
  }
  
  .pdf-thumbnails {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    max-height: 200px;
    overflow-y: auto;
    padding: 10px;
    background: var(--vp-c-bg-soft);
    border-radius: 4px;
  }
  
  .pdf-thumbnail {
    width: 80px;
    height: auto;
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 4px;
    opacity: 0.6;
    transition: all 0.2s;
    user-select: none;
    -webkit-user-select: none;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
    -webkit-touch-callout: none;
  }
  
  .pdf-thumbnail:hover {
    opacity: 1;
    border-color: var(--vp-c-brand);
  }
  
  .pdf-thumbnail.active {
    opacity: 1;
    border-color: var(--vp-c-brand);
    border-width: 3px;
  }
  
  @media (max-width: 768px) {
    .pdf-viewer-controls {
      flex-wrap: wrap;
      gap: 10px;
    }
    
    .pdf-nav-btn {
      flex: 1;
      min-width: 100px;
    }
    
    .pdf-image-wrapper {
      min-height: 400px;
      padding: 10px;
    }
    
    .pdf-thumbnails {
      max-height: 150px;
    }
    
    .pdf-thumbnail {
      width: 60px;
    }
  }
  
  /* 打印时隐藏内容或显示警告 */
  @media print {
    .pdf-images-container {
      display: none !important;
    }
    
    body::before {
      content: "本资料仅供在线预览，不提供下载。如需引用，请使用页面上的引用模板。";
      display: block;
      padding: 20px;
      text-align: center;
      font-size: 18px;
      color: #d32f2f;
      border: 2px solid #d32f2f;
      margin: 50px;
    }
  }
</style>

<script setup>
import { onMounted } from 'vue'

onMounted(() => {
  (function() {
    'use strict';
    
    let currentPage = 1;
    let totalPages = 0;
    // 获取当前页面的基础路径，使用绝对路径确保正确
    const currentPath = typeof window !== 'undefined' ? window.location.pathname : '';
    const basePath = currentPath ? currentPath.substring(0, currentPath.lastIndexOf('/')) : '/zh/tutorials/preview_document';
    const imagesBasePath = basePath + '/slides/';
    const imagePrefix = '1764349999820-6c8ddb5c-6d54-4625-9d6a-27c897c9857b_';
    const imageExtension = '.jpg';
    
    // 初始化图片查看器
    function initImageViewer() {
      const container = document.getElementById('protected-pdf-container');
      const mainImage = document.getElementById('pdf-main-image');
      const thumbnailsContainer = document.getElementById('pdf-thumbnails');
      const prevBtn = document.getElementById('prev-page');
      const nextBtn = document.getElementById('next-page');
      const currentPageSpan = document.getElementById('current-page');
      const totalPagesSpan = document.getElementById('total-pages');
      
      if (!container || !mainImage) return;
      
      // 添加主图片错误处理
      mainImage.addEventListener('error', function() {
        mainImage.style.display = 'none';
        const loadingMsg = document.getElementById('pdf-loading-message');
        if (loadingMsg) loadingMsg.style.display = 'block';
      });
      
      // 检测总页数（尝试加载图片直到失败）
      function detectTotalPages() {
        let page = 1;
        let timeoutId;
        const checkPage = () => {
          const img = new Image();
          img.onload = () => {
            page++;
            checkPage();
          };
          img.onerror = () => {
            totalPages = page - 1;
            if (totalPages > 0) {
              totalPagesSpan.textContent = totalPages;
              loadThumbnails();
              updateNavigation();
              // 隐藏加载提示
              const loadingMsg = document.getElementById('pdf-loading-message');
              if (loadingMsg) loadingMsg.style.display = 'none';
            } else {
              totalPagesSpan.textContent = '未找到图片';
              // 显示加载提示
              const loadingMsg = document.getElementById('pdf-loading-message');
              const mainImg = document.getElementById('pdf-main-image');
              if (loadingMsg && mainImg && !mainImg.complete) {
                mainImg.style.display = 'none';
                loadingMsg.style.display = 'block';
              }
            }
          };
          // 设置超时，避免无限等待
          timeoutId = setTimeout(() => {
            if (page === 1) {
              totalPagesSpan.textContent = '未找到图片';
              const loadingMsg = document.getElementById('pdf-loading-message');
              const mainImg = document.getElementById('pdf-main-image');
              if (loadingMsg && mainImg && !mainImg.complete) {
                mainImg.style.display = 'none';
                loadingMsg.style.display = 'block';
              }
            }
          }, 3000);
          img.src = `${imagesBasePath}${imagePrefix}${page}${imageExtension}`;
        };
        checkPage();
      }
      
      // 加载缩略图
      function loadThumbnails() {
        if (!thumbnailsContainer) return;
        thumbnailsContainer.innerHTML = '';
        
        for (let i = 1; i <= totalPages; i++) {
          const thumb = document.createElement('img');
          thumb.src = `${imagesBasePath}${imagePrefix}${i}${imageExtension}`;
          thumb.alt = `第 ${i} 页`;
          thumb.className = 'pdf-thumbnail';
          if (i === 1) thumb.classList.add('active');
          
          thumb.addEventListener('click', () => {
            goToPage(i);
          });
          
          thumbnailsContainer.appendChild(thumb);
        }
      }
      
      // 跳转到指定页
      function goToPage(page) {
        if (page < 1 || page > totalPages) return;
        
        currentPage = page;
        const imagePath = `${imagesBasePath}${imagePrefix}${page}${imageExtension}`;
        
        // 预加载图片
        const img = new Image();
        img.onload = () => {
          mainImage.src = imagePath;
          mainImage.alt = `社会序列分析方法入门·课程讲义 - 第 ${page} 页`;
          currentPageSpan.textContent = page;
          updateNavigation();
          updateThumbnails();
          
          // 滚动到顶部
          container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        img.onerror = () => {
          console.error(`无法加载第 ${page} 页`);
        };
        img.src = imagePath;
      }
      
      // 更新导航按钮状态
      function updateNavigation() {
        if (prevBtn) prevBtn.disabled = currentPage <= 1;
        if (nextBtn) nextBtn.disabled = currentPage >= totalPages;
      }
      
      // 更新缩略图激活状态
      function updateThumbnails() {
        const thumbs = thumbnailsContainer.querySelectorAll('.pdf-thumbnail');
        thumbs.forEach((thumb, index) => {
          if (index + 1 === currentPage) {
            thumb.classList.add('active');
          } else {
            thumb.classList.remove('active');
          }
        });
      }
      
      // 绑定导航按钮
      if (prevBtn) {
        prevBtn.addEventListener('click', () => goToPage(currentPage - 1));
      }
      if (nextBtn) {
        nextBtn.addEventListener('click', () => goToPage(currentPage + 1));
      }
      
      // 键盘导航
      document.addEventListener('keydown', (e) => {
        if (!container.contains(document.activeElement) && 
            !mainImage.contains(document.activeElement)) {
          return;
        }
        
        if (e.key === 'ArrowLeft') {
          e.preventDefault();
          goToPage(currentPage - 1);
        } else if (e.key === 'ArrowRight') {
          e.preventDefault();
          goToPage(currentPage + 1);
        }
      });
      
      // 开始检测总页数
      detectTotalPages();
    }
    
    // 保护措施：禁用右键和下载
    function initProtection() {
        const container = document.getElementById('protected-pdf-container');
        const mainImage = document.getElementById('pdf-main-image');
        const thumbnailsContainer = document.getElementById('pdf-thumbnails');
        
        if (!container) return;
        
        // 禁用右键菜单
        container.addEventListener('contextmenu', function(e) {
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
          return false;
        }, true);
        
        // 禁用图片拖拽
        function preventDrag(e) {
          e.preventDefault();
          e.stopPropagation();
          return false;
        }
        
        if (mainImage) {
          mainImage.addEventListener('dragstart', preventDrag, true);
          mainImage.addEventListener('drag', preventDrag, true);
          mainImage.addEventListener('dragend', preventDrag, true);
          mainImage.setAttribute('draggable', 'false');
          mainImage.setAttribute('ondragstart', 'return false;');
          
          // 禁用图片另存为
          mainImage.addEventListener('contextmenu', preventDrag, true);
          
          // 阻止图片被复制
          mainImage.addEventListener('copy', preventDrag, true);
          mainImage.addEventListener('cut', preventDrag, true);
        }
        
        // 保护所有缩略图
        if (thumbnailsContainer) {
          thumbnailsContainer.addEventListener('dragstart', preventDrag, true);
          thumbnailsContainer.addEventListener('contextmenu', preventDrag, true);
          
          // 监听动态添加的缩略图
          const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeType === 1 && node.tagName === 'IMG') {
                  node.addEventListener('dragstart', preventDrag, true);
                  node.addEventListener('contextmenu', preventDrag, true);
                  node.setAttribute('draggable', 'false');
                  node.setAttribute('ondragstart', 'return false;');
                }
              });
            });
          });
          
          observer.observe(thumbnailsContainer, { childList: true, subtree: true });
        }
        
        // 禁用复制和选择
        container.addEventListener('selectstart', preventDrag, true);
        container.addEventListener('select', preventDrag, true);
        container.style.userSelect = 'none';
        container.style.webkitUserSelect = 'none';
        container.style.mozUserSelect = 'none';
        container.style.msUserSelect = 'none';
        
        // 禁用打印快捷键
        document.addEventListener('keydown', function(e) {
          if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
          // 禁用 Ctrl+S / Cmd+S 保存
          if ((e.ctrlKey || e.metaKey) && e.key === 's') {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
          // 禁用 F12 开发者工具（可选）
          if (e.key === 'F12') {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
          // 禁用 Ctrl+Shift+I / Cmd+Option+I 开发者工具
          if ((e.ctrlKey || e.metaKey) && e.shiftKey && (e.key === 'I' || e.key === 'i')) {
            e.preventDefault();
            e.stopPropagation();
            return false;
          }
        }, true);
        
        // 检测打印事件
        window.addEventListener('beforeprint', function() {
          window.stop();
          alert('本资料仅供在线预览，不提供下载。如需引用，请使用页面上的引用模板。');
        });
        
        // 禁用文本选择
        document.addEventListener('selectstart', function(e) {
          if (container.contains(e.target)) {
            e.preventDefault();
            return false;
          }
        }, true);
        
        // 禁用复制粘贴
        document.addEventListener('copy', function(e) {
          if (container.contains(e.target) || (mainImage && mainImage.contains(e.target))) {
            e.preventDefault();
            if (e.clipboardData) {
              e.clipboardData.setData('text/plain', '');
            }
            return false;
          }
        }, true);
        
        // 添加水印保护（可选，通过 CSS 实现）
        const style = document.createElement('style');
        style.textContent = `
          #protected-pdf-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
            background-image: repeating-linear-gradient(
              0deg,
              transparent,
              transparent 2px,
              rgba(0,0,0,0.02) 2px,
              rgba(0,0,0,0.02) 4px
            );
          }
        `;
        document.head.appendChild(style);
        
        // 设置容器相对定位以便水印定位
        container.style.position = 'relative';
      }
    
    // 页面加载完成后初始化
    function init() {
      initImageViewer();
      initProtection();
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
    
    // VitePress 路由变化时重新初始化
    if (typeof window !== 'undefined' && window.addEventListener) {
      window.addEventListener('load', init);
    }
  })();
})
</script>

---

*本页面仅用于在线预览，PDF 文件不提供下载功能。如需引用，请使用上方提供的引用模板。*
